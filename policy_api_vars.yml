{
  "microsegmentation": {
    "resource_type": "Infra",
    "children": [
      {
        "resource_type": "ChildDomain",
        "marked_for_delete": false,
        "Domain": {
          "id": "api",
          "resource_type": "Domain",
          "marked_for_delete": false,
          "description": "api",
          "display_name": "api",
          "children": [
            {
                          "resource_type": "ChildSecurityPolicy",
                          "marked_for_delete": "false",
                          "SecurityPolicy": {
                              "id": "webapp",
                              "resource_type": "SecurityPolicy",
                              "display_name": "webapp",
                              "description": "webapp Policy",
                              "rules": [
                                  {
                                      "resource_type": "Rule",
                                      "id": "webapp-rule-01",
                                      "description": "webapp-rule-01",
                                      "display_name": "Management Outbound",
                                      "sequence_number": 50,
                                      "source_groups": [
                                         "ANY"
                                      ],
                                      "destination_groups": [
                                          "/infra/domains/api/groups/MGMT"
                                      ],
                                      "services": [
                                          "ANY"
                                      ],
                                      "profiles": [
                                          "ANY"
                                      ],
                                      "action": "ALLOW",
                                      "scope": [
                                          "/infra/domains/api/groups/WEBAPP"
                                      ]
                                  },
                                  {
                                      "resource_type": "Rule",
                                      "id": "webapp-rule-02",
                                      "description": "webapp-rule-02",
                                      "display_name": "Management Inbound",
                                      "sequence_number": 60,
                                      "source_groups": [
                                          "/infra/domains/api/groups/MGMT"
                                      ],
                                      "destination_groups": [
                                         "ANY"
                                      ],
                                      "services": [
                                          "ANY"
                                      ],
                                      "profiles": [
                                          "ANY"
                                      ],
                                      "action": "ALLOW",
                                      "scope": [
                                          "/infra/domains/api/groups/WEBAPP"
                                      ]
                                  },
                                  {
                                      "resource_type": "Rule",
                                      "id": "webapp-rule-03",
                                      "description": "webapp-rule-03",
                                      "display_name": "LB to WEB",
                                      "sequence_number": 70,
                                      "source_groups": [
                                          "/infra/domains/api/groups/LB"
                                      ],
                                      "destination_groups": [
                                          "/infra/domains/api/groups/WEB"
                                      ],
                                      "services": [
                                          "/infra/services/HTTPS"
                                      ],
                                      "profiles": [
                                          "ANY"
                                      ],
                                      "action": "ALLOW",
                                      "scope": [
                                          "/infra/domains/api/groups/WEBAPP"
                                      ]
                                  },
                                  {
                                      "resource_type": "Rule",
                                      "id": "webapp-rule-04",
                                      "description": "webapp-rule-04",
                                      "display_name": "WEB to APP",
                                      "sequence_number": 80,
                                      "source_groups": [
                                          "/infra/domains/api/groups/WEB"
                                      ],
                                      "destination_groups": [
                                          "/infra/domains/api/groups/APP"
                                      ],
                                      "services": [
                                          "ANY"
                                      ],
                                      "profiles": [
                                          "ANY"
                                      ],
                                      "action": "ALLOW",
                                      "scope": [
                                          "/infra/domains/api/groups/WEBAPP"
                                      ]
                                  },
                                  {
                                      "resource_type": "Rule",
                                      "id": "webapp-rule-05",
                                      "description": "webapp-rule-05",
                                      "display_name": "APP to DB",
                                      "sequence_number": 90,
                                      "source_groups": [
                                          "/infra/domains/api/groups/APP"
                                      ],
                                      "destination_groups": [
                                          "/infra/domains/api/groups/DB"
                                      ],
                                      "services": [
                                          "/infra/services/HTTP"
                                      ],
                                      "profiles": [
                                          "ANY"
                                      ],
                                      "action": "ALLOW",
                                      "scope": [
                                          "/infra/domains/api/groups/WEBAPP"
                                      ]
                                  },
                                  {
                                      "resource_type": "Rule",
                                      "id": "webapp-rule-06",
                                      "description": "webapp-rule-06",
                                      "display_name": "Block the rest inbound",
                                      "sequence_number": 100,
                                      "destination_groups": [
                                         "/infra/domains/api/groups/WEBAPP"
                                      ],
                                      "source_groups": [
                                         "ANY"
                                      ],
                                      "services": [
                                          "ANY"
                                      ],
                                      "profiles": [
                                          "ANY"
                                      ],
                                      "action": "DROP",
                                      "logged": "true",
                                      "scope": [
                                          "/infra/domains/api/groups/WEBAPP"
                                      ]
                                  }
                              ]
                          }
                      },
                      {
                          "resource_type": "ChildGroup",
                          "Group": {
                              "resource_type": "Group",
                              "marked_for_delete": "false",
                              "id": "MGMT",
                              "display_name": "MGMT",
                              "expression": [
                                  {
                                      "ip_addresses": [
                                          "192.168.100.1/32",
                                          "192.168.110.10/32"
                                      ],
                                      "resource_type": "IPAddressExpression",
                                      "marked_for_delete": "false"
                                  }
                              ]
                          }
                      },
                      {
                          "resource_type": "ChildGroup",
                          "Group": {
                              "resource_type": "Group",
                              "marked_for_delete": "false",
                              "id": "WEBAPP",
                              "display_name": "WEBAPP",
                              "expression": [
                                  {
                                      "member_type": "VirtualMachine",
                                      "key": "Tag",
                                      "operator": "EQUALS",
                                      "value": "webapp|",
                                      "resource_type": "Condition",
                                      "marked_for_delete": "false"
                                  }
                              ]
                          }
                      },
                      {
                          "resource_type": "ChildGroup",
                          "Group": {
                              "resource_type": "Group",
                              "marked_for_delete": false,
                              "id": "LB",
                              "display_name": "LB",
                              "expression": [
                                  {
                                      "member_type": "VirtualMachine",
                                      "key": "Tag",
                                      "operator": "EQUALS",
                                      "value": "webapp|lb",
                                      "resource_type": "Condition",
                                      "marked_for_delete": false
                                  }
                              ]
                          }
                      },
                      {
                          "resource_type": "ChildGroup",
                          "Group": {
                              "resource_type": "Group",
                              "marked_for_delete": false,
                              "id": "WEB",
                              "display_name": "WEB",
                              "expression": [
                                  {
                                      "member_type": "VirtualMachine",
                                      "key": "Tag",
                                      "operator": "EQUALS",
                                      "value": "webapp|web",
                                      "resource_type": "Condition",
                                      "marked_for_delete": false
                                  }
                              ]
                          }
                      },
                      {
                          "resource_type": "ChildGroup",
                          "Group": {
                              "resource_type": "Group",
                              "marked_for_delete": false,
                              "id": "APP",
                              "display_name": "APP",
                              "expression": [
                                  {
                                      "member_type": "VirtualMachine",
                                      "key": "Tag",
                                      "operator": "EQUALS",
                                      "value": "webapp|app",
                                      "resource_type": "Condition",
                                      "marked_for_delete": false
                                  }
                              ]
                          }
                      },
                      {
                          "resource_type": "ChildGroup",
                          "Group": {
                              "resource_type": "Group",
                              "marked_for_delete": false,
                              "id": "DB",
                              "display_name": "DB",
                              "expression": [
                                  {
                                      "member_type": "VirtualMachine",
                                      "key": "Tag",
                                      "operator": "EQUALS",
                                      "value": "webapp|db",
                                      "resource_type": "Condition",
                                      "marked_for_delete": false
                                  }
                              ]
                          }
                      }
                  ]
              }
        }    
     ]
  }



}  
  
  
  
  
  
  
   

